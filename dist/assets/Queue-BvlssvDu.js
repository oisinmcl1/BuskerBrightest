import{g as n,o as f,a as c,h as r,b as l,c as v,e as a,k as m,t as p,i as _,j as o,p as q,l as Q}from"./index-DTOr8pt5.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={name:"Queue",data(){return{uid:"",queuePosition:0,queueSize:0,activeUsers:0,intervalID:null}},created(){const e=n(o);f(e,t=>{t?this.addToQueue():this.removeUserFromQueue()}),this.intervalID=setInterval(async()=>{await this.getQueue(),await this.implementQueue()},5e3)},computed:{loadingBarWidth(){if(this.queueSize===0)return 100;const e=(this.queueSize-this.queuePosition+1)/this.queueSize*100;return Math.min(Math.max(e,0),100)}},methods:{addToQueue(){const t=n(o).currentUser;if(!t)return;this.uid=t.uid;const i=c(o);r(i,"addToQueueDB")({uid:this.uid}).then(s=>{}).catch(s=>{})},async implementQueue(){n(o).currentUser&&this.activeUsers<2&&this.queuePosition===1&&(await this.removeUserFromQueue(),await this.addToActiveUsers(),this.$router.push({path:"/menu"}),clearInterval(this.intervalID))},async removeUserFromQueue(){try{const e=c();await r(e,"removeFromQueue")({uid:this.uid})}catch{}},async addToActiveUsers(){try{const e=c();await r(e,"addToActiveUsersDB")({uid:this.uid})}catch{}},async getQueue(){if(!n(o).currentUser)return;const i=c(o),h=r(i,"getQueue");try{const u=await h({uid:this.uid});this.queuePosition=u.data.queuePosition,this.queueSize=u.data.queueSize}catch{}const s=r(i,"checkActiveUser");try{const u=await s();this.activeUsers=u.data==="No data in database"?0:u.data}catch{}},beforeRouteLeave(e,t,i){clearInterval(this.intervalId),i()}}},d=e=>(q("data-v-3d42d018"),e=e(),Q(),e),y={class:"queue-container"},g=d(()=>a("h1",null,"Welcome to the Queue",-1)),I={class:"queue-card"},T={key:0,class:"queue-info"},w=d(()=>a("span",{class:"info-title"},"Position:",-1)),z={key:1,class:"queue-info"},A=d(()=>a("span",{class:"info-title"},"Queue Size:",-1)),P=d(()=>a("div",{class:"load"},null,-1));function k(e,t,i,h,s,u){return l(),v("body",null,[a("div",y,[g,a("div",I,[s.queuePosition>0?(l(),v("div",T,[w,m(" "+p(s.queuePosition),1)])):_("",!0),s.queueSize>0?(l(),v("div",z,[A,m(" "+p(s.queueSize),1)])):_("",!0)]),P])])}const b=U(S,[["render",k],["__scopeId","data-v-3d42d018"]]);export{b as default};
